{{ template "_header.html" . }}

<div class="pad-sides-5 pad-top-5rem pad-bot-2rem text-center">
	<h1>{{ .Course.Title }}</h1>
	{{ if eq .Course.UserID .User.ID }}
		<a href="/{{ .Course.Name }}/settings">Settings</a>
	{{ end }}
	<!-- allow line breaks in the pre tag -->
	<pre style="
	overflow-x: auto;
	white-space: pre-wrap;
	white-space: -moz-pre-wrap;
	white-space: -pre-wrap;
	white-space: -o-pre-wrap;
	word-wrap: break-word;">{{ .Course.Subtitle }}</pre>
	{{ if .Release }}
		{{ if eq .Release.Price 0 }}
			<button
			style="margin-top:2rem; background-color:var(--c-code); font-weight: 600; font-size: 1rem; color:white;" 
			href="/{{ .Course.Name }}/view/{{ .Release.GetNewestVersionLogError.ID }} " 
			class="form-btn bd">(Free) Open Course</button>
		{{ else }}
			{{ if .Purchased }}
				<button
				style="margin-top:2rem; background-color:var(--c-code); font-weight: 600; font-size: 1rem; color:white;"
				class="form-btn bd" href="/{{ .Course.Name }}/view/{{ .Release.GetNewestVersionLogError.ID }}">(Purchased) Open course</button>
			{{ else }}
				{{ if .HasVersions }}
					<!-- if the user owns the course -->
					{{ if eq .Course.UserID .User.ID }}
						<button
						style="margin-top:2rem; background-color:var(--c-code); font-weight: 600; font-size: 1rem; color:white;" 
						href="/{{ .Course.Name }}/view/{{ .Release.GetNewestVersionLogError.ID }} " 
						class="form-btn bd">(Author) Open Course</button>
					{{ else }}
						<form action="/{{ .Course.Name }}/buy/{{ .Release.ID }}" method="post">
							<button type="submit"
							style="margin-top:2rem; background-color:var(--c-code); font-weight: 600; font-size: 1rem; color:white;"
							class="form-btn bd">Buy Course ${{ .Release.Price }} (USD)</button>
						</form>
					{{ end }}
				{{ else }}
					<p>(no versions released yet)</p>
				{{ end }}
			{{ end }}
		{{ end }}
	{{ else }}
			<p>(no releases yet)</p>
	{{ end }}
	<button
	style="margin-top:2rem; background-color:var(--c-code); font-weight: 600; font-size: 1rem; color:white;" 
	href="/{{ .Course.Name }}/view/{{ .Release.GetNewestVersionLogError.ID }} " 
	class="form-btn bd">
		(Bypass payment (TEMPORARY)) Open Course
	</button>
</div>
<div class="pad-sides-5 pad-top-2rem pad-bot-5rem bg-overlay">
	<div>
		{{ .Release.Markdown }}
	</div>
	<div class="pad-top-5rem">
		TODO Reviews
	</div>
</div>

{{ template "_footer.html" . }}